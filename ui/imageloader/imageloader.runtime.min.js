TW.Runtime.Widgets.imageloader=function(){function k(a){var d=e.getProperty("debugMode");d&&console.log("ImageLoader - file = "+a.name);if(-1!==".png,.jpeg,.jpg,.gif".indexOf("."+a.name.split(".").pop().toLowerCase())){var b=new FileReader;b.onload=function(){d&&console.log("ImageLoader - file = "+a.name+" loaded");$(".widget-imageloader-div-"+c).css("background-image","url("+b.result+")");$(".widget-imageloader-span-"+c).css("visibility","hidden");e.setProperty("image",b.result.substring(b.result.indexOf(",")+
1));e.jqElement.triggerHandler("LoadComplete")};e.jqElement.triggerHandler("LoadStarted");b.readAsDataURL(a)}else e.jqElement.triggerHandler("FilesNotCompatible")}function f(a,c,b,l,f){var d=e.getProperty("debugMode");if(a.dataTransfer.items){var g=[];for(var h=0;h<a.dataTransfer.items.length;h++)"file"===a.dataTransfer.items[h].kind&&g.push(a.dataTransfer.items[h].getAsFile())}else g=a.dataTransfer.files;d&&console.log("FileUploader - "+c+" - files.length = "+g.length);g&&g.length&&(l&&(a.preventDefault(),
a.dataTransfer.dropEffect="copy"),b&&e.jqElement.triggerHandler(b),f&&k(g[0]))}var e=this,c=(new Date).getTime()+"_"+Math.floor(1E3*Math.random()),m=TW.Runtime.convertLocalizableString("[[UploadWidget.imageloader.dragorclick]]","Drag your image here or click in this area");this.runtimeProperties=function(){return{supportsAutoResize:!0,needsDataLoadingAndError:!1}};this.renderHtml=function(){return'<div class="widget-content widget-imageloader widget-imageloader-'+c+'">  <div class="widget-imageloader-div widget-imageloader-div-'+
c+'">    <span class="widget-imageloader-span widget-imageloader-span-'+c+'">'+m+'</span>  </div>  <input id="load-image-'+c+'" name="load-image-'+c+'" type="file" style="display:none;"></div>'};this.afterRender=function(){var a=document.getElementById("load-image-"+c);a.setAttribute("accept",".png,.jpeg,.jpg,.gif");a.onchange=function(b){k(a.files[0]);a.value=""};var d=0,b=document.getElementsByClassName("widget-imageloader-div-"+c)[0];b.ondragenter=function(a){d++;f(a,"ondragenter","OnDragEnter",
!1,!1)};b.ondragover=function(a){f(a,"ondragover","",!0,!1)};b.ondragleave=function(a){d--;0===d&&f(a,"ondragleave","OnDragLeave",!1,!1)};b.ondrop=function(a){d=0;f(a,"ondrop","OnDrop",!0,!0)};b.onclick=function(b){b=document.createEvent("MouseEvents");b.initEvent("click",!1,!1);a.dispatchEvent(b)}};this.serviceInvoked=function(a){"Clear"===a&&($(".widget-imageloader-div-"+c).css("background-image","none"),$(".widget-imageloader-span-"+c).css("visibility","visible"),e.setProperty("image",""))}};